!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("my-mvp-range-slider",[],t):"object"==typeof exports?exports["my-mvp-range-slider"]=t():e["my-mvp-range-slider"]=t()}(window,(function(){return function(e){var t={};function a(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(i,s,function(t){return e[t]}.bind(null,s));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=6)}([function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var i=function(){function e(e){this.observers=new Set,this.lockedValues=new Set,this.state=this.initState(e),this.isReadyNotify=!0,this.isUpdated=!0}return e.prototype.addObserver=function(e){this.observers.add(e)},e.prototype.removeObserver=function(e){this.observers.delete(e)},e.prototype.getState=function(){return this.state},e.prototype.updateState=function(e){var t=this.state;this.isReadyNotify=!1,void 0!==e.unlockValues&&this.unlockState(e.unlockValues);var a=this.createState(t,e);this.state=a,this.isReadyNotify=!0,this.isUpdated||this.notify()},e.prototype.lockState=function(e){var t=this;Array.isArray(e)&&e.forEach((function(e){switch(e){case"minValue":t.lockedValues.add("minValue"),t.isUpdated=!1;break;case"maxValue":t.lockedValues.add("maxValue"),t.isUpdated=!1;break;case"step":t.lockedValues.add("step"),t.isUpdated=!1;break;case"value":t.lockedValues.add("value"),t.isUpdated=!1;break;case"secondValue":t.lockedValues.add("secondValue"),t.isUpdated=!1}})),"all"===e&&(this.lockedValues.add("maxValue"),this.lockedValues.add("minValue"),this.lockedValues.add("step"),this.lockedValues.add("value"),this.lockedValues.add("secondValue"),this.isUpdated=!1),this.isReadyNotify&&(this.state.lockedValues=Array.from(this.lockedValues)),this.isUpdated||this.notify()},e.prototype.unlockState=function(e){var t=this;Array.isArray(e)&&e.forEach((function(e){switch(e){case"minValue":t.lockedValues.delete("minValue"),t.isUpdated=!1;break;case"maxValue":t.lockedValues.delete("maxValue"),t.isUpdated=!1;break;case"step":t.lockedValues.delete("step"),t.isUpdated=!1;break;case"value":t.lockedValues.delete("value"),t.isUpdated=!1;break;case"secondValue":t.lockedValues.delete("secondValue"),t.isUpdated=!1}})),"all"===e&&(this.lockedValues.clear(),this.isUpdated=!1),this.isReadyNotify&&(this.state.lockedValues=Array.from(this.lockedValues)),this.isUpdated||this.notify()},e.prototype.initState=function(e){var t={maxValue:10,minValue:0,step:1,value:0,secondValue:void 0,lockedValues:[]};return void 0!==e?this.createState(t,e):t},e.prototype.notify=function(){0!==this.observers.size&&this.isReadyNotify&&(this.observers.forEach((function(e){e.update()})),this.isUpdated=!0)},e.prototype.isLocked=function(e){return void 0!==this.lockedValues&&this.lockedValues.has(e)},e.prototype.createState=function(t,a){var i=t.maxValue,s=t.minValue,n=t.step,r=t.value,o=t.secondValue,l=$.extend(!0,{},t,a),d=l.maxValue,u=l.minValue,c=l.step,h=l.value,p=!1,v=!1;if(l.maxValue=this.isLocked("maxValue")?i:d,l.minValue=this.isLocked("minValue")?s:u,l.step=this.isLocked("step")?n:c,this.isLocked("value")?l.value=r:(l.value=h,p=Object.prototype.hasOwnProperty.call(a,"value")),Object.prototype.hasOwnProperty.call(a,"secondValue")&&!this.isLocked("secondValue")?(l.secondValue=a.secondValue,v=!0):l.secondValue=o,d<=u||c<=0)return t;var f=l.value,y=l.secondValue;if(!e.isValid(f))return t;if(void 0===y)l.value=e.getMultipleStep(f,l);else{if(!e.isValid(y))return t;var V=e.getMultipleStep(f,l),g=e.getMultipleStep(y,l);V>g?p&&v?(l.value=g,l.secondValue=V):p?(l.value=g,l.secondValue=g):(l.value=V,l.secondValue=V):(l.value=V,l.secondValue=g)}return void 0!==a.lockedValues&&this.lockState(a.lockedValues),e.isEqualStates(t,l)||(this.isUpdated=!1),{maxValue:l.maxValue,minValue:l.minValue,step:l.step,value:l.value,secondValue:l.secondValue,lockedValues:Array.from(this.lockedValues)}},e.getMultipleStep=function(t,a){var i,s,n=a.step,r=a.maxValue,o=a.minValue;switch(!0){case t>=r:i=r;break;case t<=o:i=o;break;case(t-o)%n/n>.5:i=(s=t-(t-o)%n+n)>r?r:s;break;default:i=(s=t-(t-o)%n)+n>=r&&(r+s)/2<t?r:t-(t-o)%n}return e.fixVal(i,n)},e.isEqualStates=function(e,t){return e.maxValue===t.maxValue&&e.minValue===t.minValue&&e.step===t.step&&e.value===t.value&&e.secondValue===t.secondValue},e.isValid=function(e){return!(null===e||Number.isNaN(e)||!Number.isFinite(e))},e.fixVal=function(e,t){if(!(t%1))return+e.toFixed(0);if(t.toString().includes("e")){var a=+(""+t).split("e-")[1];return+e.toFixed(a)}var i=(""+t).split(".")[1].length;return+e.toFixed(i)},e}(),s=function(){return(s=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},n=function(){function e(e){this.model=e.model,this.view=e.view,this.callbacks={onStart:e.onStart,onChange:e.onChange,onFinish:e.onFinish,onUpdate:e.onUpdate},this.modelObserver=this.createModelObserver(),this.viewObserver=this.createViewObserver(),this.subscribeToModel(),this.subscribeToView(),this.dataValues=e.dataValues||[],this.isChanging=!1,this.isReadyRender=!0,this.renderView()}return e.prototype.update=function(t){this.isReadyRender=!1;var a=t.dataValues,i={maxValue:t.maxValue,minValue:t.minValue,step:t.step,value:t.value,lockedValues:t.lockedValues,unlockValues:t.unlockValues};Object.prototype.hasOwnProperty.call(t,"secondValue")&&(i.secondValue=t.secondValue);var n={isHorizontal:t.isHorizontal,isRange:t.isRange,isDragInterval:t.isDragInterval,hasRunner:t.hasRunner,hasBar:t.hasBar,hasScale:t.hasScale,numOfScaleVal:t.numOfScaleVal,displayScaleValue:t.displayScaleValue,displayValue:t.displayValue,displayMin:t.displayMin,displayMax:t.displayMax,prefix:t.prefix,postfix:t.postfix};a&&(a.length>1?(this.dataValues=a,i=s(s({},i),{unlockValues:"all",maxValue:a.length-1,minValue:0,step:1,lockedValues:["maxValue","minValue","step"]}),n=s(s({},n),{numOfScaleVal:a.length-2})):(this.dataValues=[],this.model.unlockState(["maxValue","minValue","step"]))),e.isEmpty(i)&&!Object.prototype.hasOwnProperty.call(t,"secondValue")||this.model.updateState(i),e.isEmpty(n)||this.view.update(n),t.onStart&&"function"==typeof t.onStart&&(this.callbacks.onStart=t.onStart),t.onChange&&"function"==typeof t.onChange&&(this.callbacks.onChange=t.onChange),t.onFinish&&"function"==typeof t.onFinish&&(this.callbacks.onFinish=t.onFinish),t.onUpdate&&"function"==typeof t.onUpdate&&(this.callbacks.onUpdate=t.onUpdate),this.callbacks.onUpdate(),this.isReadyRender=!0,this.renderView()},e.prototype.getPresenterData=function(){return{dataValues:this.dataValues}},e.prototype.setUserData=function(e){Array.isArray(e)&&e.length>1&&(this.dataValues=e,this.update({unlockValues:"all",maxValue:e.length-1,minValue:0,step:1,lockedValues:["maxValue","minValue","step"],numOfScaleVal:e.length-2}))},e.prototype.renderView=function(){if(this.isReadyRender){var e=this.model.getState();this.dataValues.length>1?this.view.render(e,this.dataValues):this.view.render(e)}},e.prototype.createModelObserver=function(){var e=this;return{update:function(){var t=e.model.getState();e.isChanging&&e.callbacks.onChange(t),e.renderView()}}},e.prototype.createViewObserver=function(){var e=this;return{start:function(){e.callbacks.onStart(e.model.getState())},change:function(t){e.isChanging=!0;var a=e.convertPercentToValue(t);if(Array.isArray(a)){var i=a[0],s=a[1];e.model.updateState({value:i,secondValue:s})}else e.model.updateState({value:a})},finish:function(){e.callbacks.onFinish(e.model.getState())},update:function(){e.renderView()}}},e.prototype.convertPercentToValue=function(e){var t,a=this.model.getState(),i=a.minValue,s=a.maxValue;Array.isArray(e)?t=[(s-i)/100*e[0]+i,(s-i)/100*e[1]+i]:t=(s-i)/100*e+i;return t},e.prototype.subscribeToModel=function(){this.model.addObserver(this.modelObserver)},e.prototype.subscribeToView=function(){this.view.addObserver(this.viewObserver)},e.isEmpty=function(e){var t=Object.entries(e),a=!0;return t.forEach((function(e){void 0!==e[1]&&(a=!1)})),a},e}(),r=(a(0),a(1),function(){return(r=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)}),o=function(){function e(t){this.$view=t.$viewContainer,this.$scale=e.createScale(),this.isRendered=!1}return e.prototype.update=function(t){var a=this.$scale.data("options"),i=t.data,s=t.options,n=r(r(r({},{isHorizontal:!0,displayScaleValue:!0,displayMin:!0,displayMax:!0,numOfScaleVal:3}),a),s);this.$scale.data("data",i),this.$scale.data("options",n);var o=n.isHorizontal,l=n.displayScaleValue;o&&!this.$scale.hasClass("slider__scale_horizontal")&&this.$scale.addClass("slider__scale_horizontal"),!o&&this.$scale.hasClass("slider__scale_horizontal")&&this.$scale.removeClass("slider__scale_horizontal"),this.isRendered||(this.$view.append(this.$scale),this.attachEventHandlers(),this.isRendered=!0);var d=i.data,u=i.percentageData;if(this.$scale.empty(),l)for(var c=d.length,h=0;h<=c-1;h+=1){var p=d[h].toString(),v=u[h],f=e.createElement(p,v,n);this.$scale.append(f),e.positionElem(f,n)}var y=0;this.$scale.find(".js-slider__scale-element").each((function(){if(o){var e=this.getBoundingClientRect().height;y=y>=e?y:e}else{var t=this.getBoundingClientRect().width;y=y>=t?y:t}})),o?this.$scale.css({height:y+"px",width:"100%"}):this.$scale.css({width:y+"px",height:"100%"})},e.prototype.destroy=function(){this.$scale.off("click"),this.$scale.remove(),this.isRendered=!1},e.prototype.attachEventHandlers=function(){this.$scale.on("click",this.handleScaleClick.bind(this))},e.prototype.handleScaleClick=function(e){var t,a=e.target;if(a.classList.contains("js-slider__scale-element")){t=$(a).data("percentage");var i=$.Event("startChanging.myMVPSlider");this.$view.trigger(i);var s=this.$scale.data("data").percentage,n=!1;if(Array.isArray(s))n=t>(s[1]+s[0])/2;var r=[t,n],o=$.Event("changeValue.myMVPSlider");this.$view.trigger(o,r);var l=$.Event("finish.myMVPSlider");this.$view.trigger(l,r)}},e.createScale=function(){return $("<div>",{class:"js-slider__scale slider__scale"})},e.createElement=function(e,t,a){var i=$("<span>",{class:"js-slider__scale-element slider__scale-element"});return i.html(e),i.data("percentage",t),a.isHorizontal&&i.addClass("slider__scale-element_horizontal"),i},e.positionElem=function(e,t){var a=e.data("percentage"),i=e[0].getBoundingClientRect();if(t.isHorizontal)switch(a){case 0:e.css({left:"calc(0% - 0.75rem)"});break;case 100:e.css({right:"calc(0% - 0.75rem)","align-items":"flex-end"});break;default:e.css({left:"calc("+a+"% - "+i.width/2+"px)","align-items":"center"})}else e.css({"padding-left":"0.8rem",top:"calc("+a+"% - "+i.height/2+"px)"})},e}(),l=(a(2),function(){return(l=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)}),d=function(){function e(t){this.$view=t.$viewContainer,this.$barContainer=t.$barContainer,this.$bar=e.createBar(),this.isRendered=!1}return e.prototype.update=function(e){var t=this.$bar.data("options"),a=e.options,i=e.data,s=l(l(l({},{isHorizontal:!0,isRange:!0,isDragInterval:!1}),t),a);this.$bar.data("options",s),this.$bar.data("data",i),!s.isHorizontal&&this.$bar.hasClass("slider__bar_horizontal")?this.$bar.removeClass("slider__bar_horizontal"):s.isHorizontal&&!this.$bar.hasClass("slider__bar_horizontal")&&this.$bar.addClass("slider__bar_horizontal"),s.isRange&&this.createRangeElement(),!s.isRange&&this.$range&&(this.$range.remove(),this.$range=void 0),this.isRendered||(this.$barContainer.append(this.$bar),this.isRendered=!0,this.attachEventHandlers())},e.prototype.destroy=function(){this.$bar.off("click"),this.$bar.remove(),this.isRendered=!1},e.prototype.attachEventHandlers=function(){this.$bar.on("click",this.handleBarClick.bind(this))},e.prototype.handleBarClick=function(e){var t,a=$.Event("startChanging.myMVPSlider");this.$view.trigger(a);var i=e.currentTarget,s=i.getBoundingClientRect();t=$(i).data("options").isHorizontal?(e.clientX-s.x)/s.width*100:(e.clientY-s.y)/s.height*100;var n=$(i).data("data"),r=!1;Array.isArray(n)&&(r=t>(n[1]+n[0])/2);var o=[t,r],l=$.Event("changeValue.myMVPSlider");this.$view.trigger(l,o);var d=$.Event("finish.myMVPSlider");this.$view.trigger(d,o)},e.prototype.createRangeElement=function(){var e=this.$bar.data(),t=e.options,a=e.data;if(this.$range||(this.$range=$("<div>",{class:"slider__range"}),this.$range.data("have-handler",!1),this.$bar.append(this.$range)),t.isHorizontal)if(this.$range.css({top:"",height:""}),Array.isArray(a)){var i=a[0],s=a[1];this.$range.css({left:i+"%",width:s-i+"%","border-radius":"0.75rem"})}else this.$range.css({left:0,width:a+"%","border-top-left-radius":"0.75rem","border-bottom-left-radius":"0.75rem"});else if(Array.isArray(a)){i=a[0],s=a[1];this.$range.css({left:"",width:"",top:i+"%",height:s-i+"%","border-radius":"0.75rem"})}else this.$range.css({width:"",top:"",height:a+"%","border-top-left-radius":"0.75rem","border-top-right-radius":"0.75rem"});var n=this.$range.data("have-handler"),r=t.isDragInterval&&Array.isArray(a);r&&!n&&(this.$range.css({cursor:"grab"}),this.$range.on("mousedown",this.handleRangeMouseDown.bind(this)),this.$range.data("have-handler",!0),this.$range[0].onclick=function(e){e.stopPropagation()},this.$range.on("dragstart",!1)),!r&&n&&(this.$range.css({cursor:"default"}),this.$range.off("mousedown"),this.$range.data("have-handler",!1),this.$range[0].onclick=null,this.$range.off("dragstart"))},e.prototype.handleRangeMouseDown=function(e){var t,a=this,i=$(e.currentTarget),s=this.$view;i.css({cursor:"grabbing"});var n=s[0].getBoundingClientRect();t=this.$bar.data("options").isHorizontal?(e.clientX-n.x)/n.width*100:(e.clientY-n.y)/n.height*100;var r=$.Event("startChanging.myMVPSlider");this.$view.trigger(r,[!0]);var o=this.makeViewDragHandler(t);s.on("mousemove",o),document.onmouseup=function(){a.$view.off("mousemove",o),i.css({cursor:"grab"});var e=$.Event("dropRange.myMVPSlider");a.$view.trigger(e),document.onmouseup=null}},e.prototype.makeViewDragHandler=function(e){var t=this;return function(a){var i=t.$view[0].getBoundingClientRect(),s=(t.$bar.data("options").isHorizontal?(a.clientX-i.x)/i.width*100:(a.clientY-i.y)/i.height*100)-e,n=$.Event("dragRange.myMVPSlider");t.$view.trigger(n,[s])}},e.createBar=function(){return $("<div>",{class:"js-slider__bar slider__bar"})},e}(),u=(a(3),function(){return(u=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)}),c=function(){function e(t){this.$barContainer=t.$barContainer,this.$view=t.$viewContainer,this.$runner=e.createRunner(),this.isRendered=!1,this.isSecond=!0===t.isSecond}return e.prototype.update=function(e){var t=e.data,a=e.options,i=this.$runner.data("options"),s=u(u(u({},{isHorizontal:!0}),i),a);s.isHorizontal&&!this.$runner.hasClass("slider__runner_horizontal")&&this.$runner.addClass("slider__runner_horizontal"),!s.isHorizontal&&this.$runner.hasClass("slider__runner_horizontal")&&this.$runner.removeClass("slider__runner_horizontal"),this.isSecond?this.$runner.addClass("runner_second"):this.$runner.addClass("runner_first"),this.isRendered||(this.$barContainer.append(this.$runner),this.attacheEventHandlers(),this.isRendered=!0);var n,r,o=this.$runner[0].getBoundingClientRect().width;if(Array.isArray(t.percentage)){var l=t.percentage,d="calc("+l[0]+"% - "+o/2+"px)",c="calc("+l[1]+"% - "+o/2+"px)";r=this.isSecond?c:d}else r="calc("+t.percentage+"% - "+o/2+"px)";if(Array.isArray(t.value)){var h=t.value,p=h[0],v=h[1];n=this.isSecond?v:p}else n=t.value;this.$runner.data("options",s),this.$runner.data("value",n),a.isHorizontal?(this.$runner.css("top",""),this.$runner.css({left:r})):(this.$runner.css("left",""),this.$runner.css({top:r}))},e.prototype.destroy=function(){this.$runner.off("mousedown"),this.$runner.remove(),this.isRendered=!1},e.prototype.attacheEventHandlers=function(){this.$runner.on("mousedown",this.handleRunnerMouseDown.bind(this)),this.$runner.on("dragstart",!1)},e.prototype.handleRunnerMouseDown=function(e){var t=this,a=$.Event("startChanging.myMVPSlider");this.$view.trigger(a);var i=e.currentTarget,s=$(i).data("options"),n=this.makeViewMouseMoveHandler(s);this.$view.on("mousemove",n),document.onmouseup=function(){t.$view.off("mousemove",n);var e=$.Event("finish.myMVPSlider");t.$view.trigger(e),document.onmouseup=null}},e.prototype.makeViewMouseMoveHandler=function(e){var t,a,i=this,s=this.$barContainer[0].getBoundingClientRect();return function(n){e.isHorizontal?(t=n.clientX-s.x,a=t/s.width*100):(t=n.clientY-s.y,a=t/s.height*100);var r=$.Event("changeValue.myMVPSlider");i.$view.trigger(r,[a,i.isSecond])}},e.createRunner=function(){return $("<div>",{class:"js-slider__runner slider__runner"})},e}(),h=(a(4),function(){return(h=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)}),p=function(){function e(t){this.$view=t.$viewContainer,this.$displayContainer=e.createValuesDisplayContainer(),this.isRendered=!1}return e.prototype.update=function(e){var t=e.data,a=e.options,i=this.$displayContainer.data("options"),s=h(h(h({},{isHorizontal:!0,prefix:"",postfix:""}),i),a);this.$displayContainer.data({options:s,data:t.value}),s.isHorizontal&&!this.$displayContainer.hasClass("slider__display-container_horizontal")&&this.$displayContainer.addClass("slider__display-container_horizontal"),!s.isHorizontal&&this.$displayContainer.hasClass("slider__display-container_horizontal")&&this.$displayContainer.removeClass("slider__display-container_horizontal"),this.isRendered||(this.$view.prepend(this.$displayContainer),this.isRendered=!0),this.updateValueDisplay({data:t,options:s}),this.attachEventHandlers()},e.prototype.destroy=function(){this.$displayContainer.remove(),this.$firstValDisplay&&(this.$firstValDisplay.remove(),this.$firstValDisplay=void 0),this.$secondValDisplay&&(this.$secondValDisplay.remove(),this.$secondValDisplay=void 0),this.isRendered=!1},e.prototype.updateValueDisplay=function(t){var a,i,s,n=this.$displayContainer.data("options"),r=t.data,o=t.options,l=void 0===o?n:o,d=r.value,u=r.percentage,c=l.isHorizontal;if(this.$firstValDisplay||(this.$firstValDisplay=e.createValueDisplay(),this.$firstValDisplay.data({isSecond:!1}),this.$displayContainer.append(this.$firstValDisplay)),c&&!this.$firstValDisplay.hasClass("slider__display-value_horizontal")&&this.$firstValDisplay.addClass("slider__display-value_horizontal"),!l.isHorizontal&&this.$firstValDisplay.hasClass("slider__display-value_horizontal")&&this.$firstValDisplay.removeClass("slider__display-value_horizontal"),Array.isArray(d)){i=d[0],s=d[1],this.$secondValDisplay||(this.$secondValDisplay=e.createValueDisplay(),this.$secondValDisplay.data({isSecond:!0}),this.$displayContainer.append(this.$secondValDisplay)),l.isHorizontal&&!this.$secondValDisplay.hasClass("slider__display-value_horizontal")&&this.$secondValDisplay.addClass("slider__display-value_horizontal"),!l.isHorizontal&&this.$secondValDisplay.hasClass("slider__display-value_horizontal")&&this.$secondValDisplay.removeClass("slider__display-value_horizontal"),this.$secondValDisplay.data("data",s),this.$secondValDisplay.data("options",l);var h=""+l.prefix;h+=s.toString(),""!==l.postfix&&(h+=l.postfix),this.$secondValDisplay.html(h),this.$firstValDisplay.data("data",i),this.$firstValDisplay.data("options",l)}else i=d,this.$firstValDisplay.data("data",i),this.$firstValDisplay.data("options",l),this.$secondValDisplay&&(this.$secondValDisplay.remove(),this.$secondValDisplay=void 0);a=Array.isArray(u)?u[0]:u;var p=""+l.prefix;p+=i.toString(),""!==l.postfix&&(p+=l.postfix),this.$firstValDisplay.html(p);var v,f,y=this.$firstValDisplay[0].getBoundingClientRect();if(c){v="calc("+a+"% - "+y.width/2+"px)",this.$firstValDisplay.css({top:"",left:v});var V=this.$firstValDisplay[0].getBoundingClientRect(),g=V.x,$=V.width,m=this.$view[0].getBoundingClientRect(),b=m.x,w=m.width;if(g<b&&this.$firstValDisplay.css({left:"calc(0% - 0.75rem)"}),g+$>b+w&&this.$firstValDisplay.css({left:"calc("+(w-$)+"px - 0.75rem)"}),this.$secondValDisplay&&Array.isArray(u)){var _=this.$secondValDisplay[0].getBoundingClientRect();f="calc("+u[1]+"% - "+_.width/2+"px)",this.$secondValDisplay.css({top:"",left:f});var D=this.$secondValDisplay[0].getBoundingClientRect(),C=D.x,S=D.width;C+S>b+w&&this.$secondValDisplay.css({left:"calc("+(w-S)+"px - 0.75rem)"})}}else{v="calc("+a+"% - "+y.height/2+"px)",this.$firstValDisplay.css({left:"",top:v});var k=this.$firstValDisplay[0].getBoundingClientRect(),x=k.y,R=k.height,O=this.$view[0].getBoundingClientRect(),M=O.y,z=O.height;if(x<M&&this.$firstValDisplay.css({top:"calc(0% - 0.75rem)"}),x+R>M+z&&this.$firstValDisplay.css({top:"calc("+(z-R)+"px - 0.75rem)"}),this.$secondValDisplay&&Array.isArray(u)){_=this.$secondValDisplay[0].getBoundingClientRect();f="calc("+u[1]+"% - "+_.height/2+"px)",this.$secondValDisplay.css({left:"",top:f});var P=this.$secondValDisplay[0].getBoundingClientRect(),H=P.y,A=P.height;H+A>M+z&&this.$secondValDisplay.css({top:"calc("+(z-A)+"px - 0.75rem)"})}}},e.prototype.attachEventHandlers=function(){this.$firstValDisplay&&(this.$firstValDisplay.on("mousedown",this.handleValueMouseDown.bind(this)),this.$firstValDisplay.on("dragstart",!1)),this.$secondValDisplay&&(this.$secondValDisplay.on("mousedown",this.handleValueMouseDown.bind(this)),this.$secondValDisplay.on("dragstart",!1))},e.prototype.handleValueMouseDown=function(e){var t=this,a=$.Event("startChanging.myMVPSlider");this.$view.trigger(a);var i=$(e.currentTarget).data("isSecond"),s=this.makeViewMouseMoveHandler(i);this.$view.on("mousemove",s),document.onmouseup=function(){t.$view.off("mousemove");var e=$.Event("finish.myMVPSlider");t.$view.trigger(e),document.onmouseup=null}},e.prototype.makeViewMouseMoveHandler=function(e){var t,a,i=this,s=this.$displayContainer[0].getBoundingClientRect(),n=this.$displayContainer.data("options").isHorizontal;return function(r){n?(t=r.clientX-s.x,a=t/s.width*100):(t=r.clientY-s.y,a=t/s.height*100);var o=$.Event("changeValue.myMVPSlider");i.$view.trigger(o,[a,e])}},e.createValuesDisplayContainer=function(){return $("<div>",{class:"js-slider__display-container slider__display-container"})},e.createValueDisplay=function(){return $("<div>",{class:"js-slider__display-value slider__display-value"})},e}(),v=function(){return(v=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},f=function(){function e(e,t){this.$container=$(e),this.viewOptions=t,this.observers=new Set,this.$view=this.createView(),this.$barContainer=$("<div>",{class:"js-slider__bar-container slider__bar-container"}),this.$view.append(this.$barContainer),this.isRendered=!1}return e.prototype.render=function(e,t){this.viewOptions.isHorizontal&&!this.$view.hasClass("slider__container_horizontal")&&(this.$view.addClass("slider__container_horizontal"),this.$barContainer.addClass("slider__bar-container_horizontal")),!this.viewOptions.isHorizontal&&this.$view.hasClass("slider__container_horizontal")&&(this.$view.removeClass("slider__container_horizontal"),this.$barContainer.removeClass("slider__bar-container_horizontal")),this.isRendered||(this.$container.append(this.$view),this.attachEventHandlers(),this.isRendered=!0),this.renderData=this.createRenderData(e,t),this.updateValuesDisplay(this.renderData),this.updateScale(this.renderData),this.updateBar(this.renderData.percentage),this.updateRunners(this.renderData)},e.prototype.update=function(t){var a=e.validateData(t),i=$.extend({},this.viewOptions,a);this.viewOptions=i,this.$view.data("options",i),this.notify({event:"update"})},e.prototype.addObserver=function(e){this.observers.add(e)},e.prototype.removeObserver=function(e){this.observers.delete(e)},e.prototype.getData=function(){return this.viewOptions},e.prototype.destroy=function(){this.bar&&(this.bar.destroy(),this.bar=void 0),this.scale&&(this.scale.destroy(),this.scale=void 0),this.runner&&(this.runner.destroy(),this.runner=void 0),this.secondRunner&&(this.secondRunner.destroy(),this.secondRunner=void 0),this.valueDisplay&&(this.valueDisplay.destroy(),this.valueDisplay=void 0),this.$view.remove(),this.isRendered=!1},e.prototype.createView=function(){var e=this.viewOptions,t=$("<div>",{class:"js-slider__container slider__container"});return t.data("options",e),t},e.prototype.updateBar=function(e){var t;this.viewOptions.hasBar?(this.bar=this.bar||new d({$viewContainer:this.$view,$barContainer:this.$barContainer}),this.bar.update({data:e,options:this.viewOptions})):null===(t=this.bar)||void 0===t||t.destroy()},e.prototype.updateScale=function(e){var t;this.viewOptions.hasScale?(this.scale=this.scale||new o({$viewContainer:this.$view}),this.scale.update({data:e,options:this.viewOptions})):null===(t=this.scale)||void 0===t||t.destroy()},e.prototype.updateValuesDisplay=function(e){var t,a={data:e,options:this.viewOptions};this.viewOptions.displayValue?(this.valueDisplay=this.valueDisplay||new p({$viewContainer:this.$view}),this.valueDisplay.update(a)):null===(t=this.valueDisplay)||void 0===t||t.destroy()},e.prototype.updateRunners=function(e){if(!this.viewOptions.hasRunner)return this.runner&&(this.runner.destroy(),this.runner=void 0),void(this.secondRunner&&(this.secondRunner.destroy(),this.runner=void 0));var t={data:e,options:this.viewOptions};this.runner=this.runner||new c({$viewContainer:this.$view,$barContainer:this.$barContainer,isSecond:!1}),this.runner.update(t),Array.isArray(e.value)?(this.secondRunner=this.secondRunner||new c({$viewContainer:this.$view,$barContainer:this.$barContainer,isSecond:!0}),this.secondRunner.update(t)):this.secondRunner&&(this.secondRunner.destroy(),this.secondRunner=void 0)},e.prototype.notify=function(e){if(this.observers.size>0)switch(e.event){case"start":this.observers.forEach((function(e){e.start()}));break;case"change":this.observers.forEach((function(t){void 0!==e.value&&t.change(e.value)}));break;case"finish":this.observers.forEach((function(e){e.finish()}));break;case"update":this.observers.forEach((function(e){e.update()}))}},e.prototype.attachEventHandlers=function(){this.$view.on("startChanging.myMVPSlider",this.handleViewStartChanging.bind(this)),this.$view.on("changeValue.myMVPSlider",this.handleViewChangeValue.bind(this)),this.$view.on("finish.myMVPSlider",this.handleViewFinish.bind(this)),this.$barContainer.on("dragstart",!1)},e.prototype.handleViewStartChanging=function(e,t){var a;this.notify({event:"start"});var i=null===(a=this.renderData)||void 0===a?void 0:a.percentage;if(t&&Array.isArray(i)){var s=this.makeRangeDragHandler(i),n=this.makeRangeDropHandler();this.$view.on("dragRange.myMVPSlider",s),this.$view.on("dropRange.myMVPSlider",n)}},e.prototype.makeRangeDragHandler=function(e){var t=this;return function(a,i){var s=e[1]-e[0],n=e[0]+i,r=e[1]+i;n<0&&(r=(n=0)+s),r>100&&(n=(r=100)-s);var o={event:"change",value:[n,r]};t.notify(o)}},e.prototype.makeRangeDropHandler=function(){var e=this;return function(){e.notify({event:"finish"}),e.$view.off("dragRange.myMVPSlider",!1),e.$view.off("dropRange.myMVPSlider",!1)}},e.prototype.handleViewChangeValue=function(e,t,a){if(this.renderData){var i=this.renderData.percentage,s=void 0;if(Array.isArray(i))s={event:"change",value:a?[i[0],t]:[t,i[1]]};else s={event:"change",value:t};this.notify(s)}},e.prototype.handleViewFinish=function(){this.notify({event:"finish"})},e.prototype.createRenderData=function(t,a){var i,s=t.value,n=t.secondValue,r=void 0!==n;r?i=[e.convertValueToPercent(s,t),e.convertValueToPercent(Number(n),t)]:i=e.convertValueToPercent(s,t);var o,l,d=this.createDataValues(t),u=e.createPercentageData(d,t);return a&&a.length?(o=r?[a[s],a[Number(n)]]:a[s],l=d.map((function(e){return a[e]}))):(o=r?[s,n]:s,l=d),{data:l,percentageData:u,value:o,percentage:i}},e.prototype.createDataValues=function(t){var a=t.minValue,i=t.maxValue,s=t.step,n=this.viewOptions,r=n.displayMax,o=void 0===r||r,l=n.displayMin,d=void 0===l||l,u=n.numOfScaleVal,c=void 0===u?10:u,h=[];d&&h.push(a);var p=(i-a)/s,v=p%1==0?p-1:Math.floor(p);if(c>=v)for(var f=1;f<=v;f+=1){var y=a+s*f;h.push(e.fixVal(y,s))}else{var V=(i-a)/(c+1);for(f=1;f<=c;f+=1){var g=((y=a+V*f)-a)%s>s/2?y-(y-a)%s+s:y-(y-a)%s;h.push(e.fixVal(g,s))}}return o&&h.push(i),h},e.createPercentageData=function(t,a){var i=a.minValue,s=a.maxValue,n=a.step/(s-i);return t.map((function(t){var a=(t-i)/(s-i)*100;return e.fixVal(a,n)}))},e.convertValueToPercent=function(t,a){var i=a.minValue,s=a.maxValue,n=a.step/(s-i),r=(t-i)/(s-i)*100;return e.fixVal(r,n)},e.validateData=function(t){return Object.entries(t).filter((function(t){switch(t[0]){case"isHorizontal":case"isRange":case"isDragInterval":case"hasRunner":case"hasBar":case"hasScale":case"displayScaleValue":case"displayValue":case"displayMin":case"displayMax":return"boolean"==typeof t[1];case"numOfScaleVal":return e.isValidNumOfValue(t[1]);case"prefix":case"postfix":return"string"==typeof t[1];default:return!1}})).reduce((function(e,t){var a,i=t[0],s=t[1];return v(v({},e),((a={})[i]=s,a))}),{})},e.isValidNumOfValue=function(e){return"number"==typeof e&&(Number.isFinite(e)&&e>=0&&e<=10)},e.fixVal=function(e,t){if(!(t%1))return+e.toFixed(0);if(t.toString().includes("e")){var a=+(""+t).split("e-")[1];return+e.toFixed(a)}var i=(""+t).split(".")[1].length;return+e.toFixed(i)},e}(),y=function(){return(y=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},V=function(){function e(t,a){this.initOptions=t,this.options=t,this.node=a,this.model=new i(t),this.view=new f(this.node,t),this.presenter=e.initPresenter(this.model,this.view,t)}return e.prototype.update=function(e){this.options=y(y(y({},this.initOptions),this.options),e),this.presenter.update(e)},e.prototype.setUserData=function(e){e.length>1?this.presenter.setUserData(e):this.reset()},e.prototype.getAllData=function(){return y(y(y({},this.getModelData()),this.getViewData()),this.getPresenterData())},e.prototype.getModelData=function(){return this.model.getState()},e.prototype.getViewData=function(){return this.view.getData()},e.prototype.getPresenterData=function(){return this.presenter.getPresenterData()},e.prototype.lockValues=function(e){this.presenter.update({lockedValues:e})},e.prototype.unlockValues=function(e){this.presenter.update({unlockValues:e})},e.prototype.reset=function(){this.options=this.initOptions,this.presenter.update(this.initOptions)},e.prototype.destroy=function(){this.view.destroy()},e.initPresenter=function(e,t,a){var i=a.dataValues,s=a.onStart,r=void 0===s?function(){}:s,o=a.onChange,l=void 0===o?function(){}:o,d=a.onFinish,u=void 0===d?function(){}:d,c=a.onUpdate;return new n({model:e,view:t,dataValues:i,onStart:r,onChange:l,onFinish:u,onUpdate:void 0===c?function(){}:c})},e}(),g=function(){return(g=Object.assign||function(e){for(var t,a=1,i=arguments.length;a<i;a++)for(var s in t=arguments[a])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};$.fn.myMVPSlider=function(e){var t,a={maxValue:100,minValue:0,step:1,value:0,secondValue:void 0,isHorizontal:!0,isRange:!0,isDragInterval:!1,hasRunner:!0,hasBar:!0,hasScale:!0,numOfScaleVal:3,displayScaleValue:!0,displayValue:!0,displayMin:!0,displayMax:!0,prefix:"",postfix:"",dataValues:[],onStart:function(){},onChange:function(){},onFinish:function(){},onUpdate:function(){}};if("destroy"===e)this.each((function(){var e=$(this).data("myMVPSlider");e&&(e.destroy(),$(this).data({myMVPSlider:void 0,"init-options":void 0}))}));else{if(e){var i=Object.entries(e).map((function(e){var t=e[0];switch(t){case"maxValue":case"minValue":case"step":case"value":case"secondValue":if(null===e[1]||Number.isNaN(e[1]))break;return e;case"isHorizontal":case"isRange":case"isDragInterval":case"hasRunner":case"hasBar":case"hasScale":case"displayScaleValue":case"displayValue":case"displayMin":case"displayMax":if("boolean"==typeof e[1])return e;break;case"numOfScaleVal":if("number"==typeof e[1]&&e[1]>=0)return e;break;case"prefix":case"postfix":if("string"==typeof e[1])return e;break;case"dataValues":if(Array.isArray(e[1]))return e;break;case"onStart":case"onChange":case"onFinish":case"onUpdate":if("function"==typeof e[1])return e;break;default:return e}return[t,a[t]]}));t=i.reduce((function(e,t){var a,i=t[0],s=t[1];return g(g({},e),((a={})[i]=s,a))}),{})}this.each((function(){var e=$(this),i=e.data(),s=$.extend({},a,t,i),n=new V(s,this);e.data("myMVPSlider",n),e.data("init-options",s)}))}return this}}])}));